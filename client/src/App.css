/* ===== Reset & Vars ===== */
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#312e2b;--bg2:#272522;--bg3:#21201d;
  --brd:#3d3b37;--txt:#fff;--dim:#bbb;--mut:#888;
  --grn:#81b64c;--grn2:#95ca57;
}
html,body,#root{height:100%;height:100dvh;overflow:hidden}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--txt)}

/* ===== App Shell ===== */
.app{
  height:100vh;
  display:grid;
  grid-template-rows:42px 1fr 42px;
  grid-template-columns:1fr 340px;
  grid-template-areas:
    "top top"
    "board side"
    "bot bot";
}

/* ===== Player Bars (top / bottom) ===== */
.top-bar{grid-area:top;background:var(--bg2);border-bottom:1px solid var(--brd);display:flex;align-items:center;padding:0 16px}
.bot-bar{grid-area:bot;background:var(--bg2);border-top:1px solid var(--brd);display:flex;align-items:center;padding:0 16px}

.player-bar{display:flex;align-items:center;gap:8px;padding:0 8px}
.pb-icon{font-size:1.4rem;line-height:1}
.pb-name{font-size:.8125rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.captured-pieces{display:flex;gap:2px;margin-left:4px;align-items:center}
.captured-piece{font-size:1rem;line-height:1;opacity:.7}
.material-score{font-size:.75rem;font-weight:700;color:var(--grn);margin-left:4px}
.pb-side{font-size:.625rem;color:var(--mut);text-transform:uppercase;letter-spacing:.5px}
.pb-dot{width:8px;height:8px;border-radius:50%;margin-left:auto;flex-shrink:0}
.dot-active{background:var(--grn)}
.dot-think{background:#f0c040;animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.25}}

/* ===== Board Area (center) ===== */
.board-col{
  grid-area:board;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
  overflow:hidden;
}
.board-frame{
  --board-size:min(calc(100vh - 110px), calc(100vw - 390px), 800px);
  width:var(--board-size);
  height:var(--board-size);
  flex-shrink:0;
}

/* ===== Side Column ===== */
.side-col{
  grid-area:side;
  background:var(--bg3);
  border-left:1px solid var(--brd);
  display:flex;flex-direction:column;
  overflow:hidden;
}
.side-inner{
  flex:1;display:flex;flex-direction:column;
  padding:16px;gap:12px;
  overflow-y:auto;
}

/* ===== AI Settings ===== */
.ai-settings h3{font-size:.9375rem;font-weight:700;color:var(--grn);text-align:center;margin-bottom:2px}
.settings-columns{display:flex;flex-direction:column;gap:16px}
.ai-column h4{font-size:.625rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--mut);padding-bottom:6px;margin-bottom:8px;border-bottom:1px solid var(--brd)}
.setting-row{margin-bottom:8px}
.setting-row label{display:block;font-size:.625rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--dim);margin-bottom:3px}
.setting-row select{
  width:100%;background:var(--bg2);color:var(--txt);
  border:1px solid var(--brd);border-radius:4px;
  padding:7px 28px 7px 8px;font-size:.8125rem;
  outline:none;cursor:pointer;transition:border-color .15s;
  appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23888' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:right 8px center;
}
.setting-row select:focus{border-color:var(--grn)}
.setting-row select option{background:var(--bg2);color:var(--txt)}
.setting-row .search-input{
  width:100%;background:var(--bg3);border:1px solid var(--brd);
  color:var(--txt);padding:7px 10px;border-radius:4px;font-size:.8125rem;
  transition:border-color .15s;
}
.setting-row .search-input:focus{border-color:var(--grn);outline:none}
.setting-row .search-input::placeholder{color:var(--mut)}
.setting-row .searching{font-size:.75rem;color:var(--mut);margin-left:8px}

/* ===== Start Button ===== */
.btn-start{
  width:100%;background:var(--grn);color:#fff;border:none;
  border-radius:6px;padding:11px;font-size:.875rem;font-weight:700;
  cursor:pointer;text-transform:uppercase;letter-spacing:.8px;transition:background .15s;
}
.btn-start:hover:not(:disabled){background:var(--grn2)}
.btn-start:disabled{opacity:.4;cursor:not-allowed}

/* ===== Warning / Error ===== */
.warn-box{padding:12px;background:rgba(255,193,7,.1);border:1px solid #ffc107;border-radius:6px;font-size:.8125rem}
.warn-box strong{color:#ffc107;display:block;margin-bottom:4px}
.warn-box p{color:var(--dim);font-size:.75rem}
.warn-box code{background:var(--bg2);padding:1px 4px;border-radius:3px;font-size:.7rem}
.err-box{padding:10px 12px;background:rgba(244,67,54,.1);border:1px solid #e53935;border-radius:6px;color:#ef5350;font-size:.8125rem;font-weight:500}

/* ===== Move List ===== */
.move-list-wrap{flex:1;display:flex;flex-direction:column;overflow:hidden;background:var(--bg2);border-radius:6px}
.ml-head{padding:7px 12px;font-size:.625rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--mut);border-bottom:1px solid var(--brd)}
.ml-body{flex:1;overflow-y:auto;padding:2px 0}
.ml-empty{padding:14px;text-align:center;color:var(--mut);font-size:.8125rem}
.ml-row{display:flex;align-items:center;padding:2px 12px;font-size:.8125rem;font-family:'Courier New',monospace}
.ml-row:hover{background:rgba(255,255,255,.03)}
.ml-num{width:28px;color:var(--mut);font-size:.6875rem;flex-shrink:0}
.ml-w,.ml-b{flex:1;padding:2px 4px;border-radius:2px}

/* ===== AI Reasoning Box ===== */
.reasoning-box{
  background:rgba(129,182,76,.08);border:1px solid rgba(129,182,76,.2);
  border-radius:6px;padding:10px 12px;margin-bottom:8px;
}
.reasoning-label{
  font-size:.625rem;font-weight:700;text-transform:uppercase;
  letter-spacing:.5px;color:var(--grn);margin-bottom:6px;
}
.reasoning-text{
  font-size:.8125rem;line-height:1.5;color:var(--txt);
}

/* ===== Status Bars ===== */
.status-bar{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:6px;font-size:.8125rem;font-weight:500}
.status-bar.thinking{background:rgba(240,192,64,.08);color:#f0c040}
.spinner{width:12px;height:12px;border:2px solid rgba(240,192,64,.25);border-top-color:#f0c040;border-radius:50%;animation:spin .7s linear infinite;flex-shrink:0}
@keyframes spin{to{transform:rotate(360deg)}}

/* ===== Result Box ===== */
.result-box{padding:14px;background:rgba(129,182,76,.1);border:1px solid var(--grn);border-radius:6px;text-align:center}
.result-score{font-size:1.25rem;font-weight:700;color:var(--grn)}
.result-reason{font-size:.8125rem;color:var(--dim);margin-top:2px}

/* ===== Game Controls ===== */
.ctrl-wrap{margin-top:auto;padding-top:8px;border-top:1px solid var(--brd)}
.game-controls{display:flex;flex-direction:column;gap:8px}
.control-btn{
  width:100%;background:var(--bg2);border:1px solid var(--brd);
  color:var(--txt);padding:10px 14px;border-radius:6px;
  cursor:pointer;font-size:.8125rem;font-weight:600;
  transition:all .2s ease;
  display:flex;align-items:center;justify-content:center;gap:8px;
}
.control-btn svg{flex-shrink:0;transition:transform .2s ease}
.control-btn span{font-size:.8125rem;letter-spacing:.3px}
.control-btn:hover:not(:disabled){
  background:var(--bg);border-color:var(--grn);
  transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,0.3)
}
.control-btn:hover:not(:disabled) svg{transform:scale(1.1)}
.control-btn:active:not(:disabled){transform:translateY(0);box-shadow:0 1px 3px rgba(0,0,0,0.2)}
.control-btn:disabled{opacity:.3;cursor:not-allowed}
.control-btn-primary{background:var(--grn);border-color:var(--grn);color:#fff}
.control-btn-primary:hover:not(:disabled){background:var(--grn2);border-color:var(--grn2)}

/* ===== Responsive - Tablet ===== */
@media(max-width:900px){
  .app{grid-template-columns:1fr 280px}
  .board-frame{--board-size:min(calc(100vh - 110px), calc(100vw - 320px), 700px)}
}

/* ===== Responsive - Phone ===== */
@media(max-width:600px){
  .app{
    height:100dvh;
    grid-template-rows:36px minmax(0,1fr) auto;
    grid-template-columns:1fr;
    grid-template-areas:
      "top"
      "board"
      "side";
    overflow:hidden;
  }
  .top-bar{height:36px;min-height:36px;padding:0 10px}
  .bot-bar{display:none}
  .board-col{padding:2px;overflow:hidden}
  .board-frame{
    --bw:calc(100vw - 4px);
    --bh:calc(100dvh - 36px - 180px);
    width:min(var(--bw), var(--bh));
    height:min(var(--bw), var(--bh));
  }
  .side-col{
    border-left:none;border-top:1px solid var(--brd);
    min-height:180px;max-height:180px;
    overflow-y:auto;
  }
  .side-inner{padding:10px;gap:8px}
  .ai-settings h3{font-size:.8125rem}
  .settings-columns{gap:10px}
  .setting-row{margin-bottom:4px}
  .setting-row select{padding:10px 28px 10px 8px;font-size:.875rem}
  .btn-start{padding:12px;font-size:.875rem}
  .game-controls{flex-direction:row;gap:6px}
  .control-btn{flex:1;padding:10px 8px;font-size:.75rem}
  .control-btn span{font-size:.75rem}
  .ml-row{font-size:.75rem}
  .status-bar{font-size:.75rem;padding:6px 10px}
  .pb-name{font-size:.75rem}
  .pb-icon{font-size:1.2rem}
  .move-list-wrap{max-height:80px}
}
